import{_ as A,S as w,r as d,d as x,o as u,c as h,a as C,w as l,Y as b,Z as F,V as D,f as n,a0 as c}from"./index-786b1c77.js";import{L as B}from"./index-fdda10ed.js";import"./index-ea81e4d8.js";import{C as E}from"./index-5d01f35b.js";const I={class:"title"},V={class:"detail"},j={class:"desc"},N={__name:"ArticleList",props:{articleData:{type:Array,default:[]},apiFn:{type:Function,default:null},params:{type:Object,default:null},status:{type:Number,default:2}},setup(g){const o=g,p=w(),r=d([]),i=d(!1),f=d(!1),y=async()=>{const e=[];try{const a=await o.apiFn(o.params);if((a==null?void 0:a.code)!==0||a.data.list===null||a.data.list===void 0||a.data.list.length===0)return e;if(o.params.type===1)for(const t of a.data.list)e.push({id:t.object_id,title:t.goods.name,desc:(t.goods.price/100).toFixed(2),pic_url:t.goods.pic_url,detail:t.goods.detail_info,created_at:t.goods.created_at});else for(const t of a.data.list)e.push({id:t.object_id,title:t.article.title,desc:t.article.desc,pic_url:t.article.pic_url,created_at:t.article.created_at});return e}catch(a){return console.error("Error fetching liked articles:",a),e}},v=async()=>{console.log("fetchDefaultArticles");try{const e=await o.apiFn(o.params);return(e==null?void 0:e.code)!==0?[]:e.data.list===null?[]:e.data.list}catch(e){return console.error("Error fetching default articles:",e),[]}},_=new Set,m=async()=>{i.value=!0;try{let e=[];if(o.params.type!==void 0?e=await y():e=await v(),e.length===0)f.value=!0;else{const a=e.filter(t=>_.has(t.id)?!1:(_.add(t.id),!0));r.value=[...r.value,...a],o.params.page+=1}}catch(e){console.error("Error loading articles:",e)}finally{i.value=!1}console.log("List Value: ",r.value)},k=e=>{if(o.status===2){p.push({path:"/article-detail",query:{articleId:e.id}});return}p.push({name:"goodsDetail",params:{goodsId:e.id}})};return x(()=>{r.value=[],m()}),(e,a)=>{const t=E,L=B;return u(),h("div",null,[C(L,{class:"content",loading:i.value,"onUpdate:loading":a[0]||(a[0]=s=>i.value=s),finished:f.value,"immediate-check":!1,"finished-text":"没有更多了",onLoad:m,offset:""},{default:l(()=>[(u(!0),h(b,null,F(r.value,s=>(u(),D(t,{class:"item",key:s.id,thumb:s.pic_url,onClick:S=>k(s)},{title:l(()=>[n("p",I,c((s==null?void 0:s.title)||"default"),1)]),desc:l(()=>[n("p",V,c(s.detail),1)]),price:l(()=>[n("p",j,c(s.desc),1)]),num:l(()=>[n("p",null,c(s.created_at),1)]),_:2},1032,["thumb","onClick"]))),128))]),_:1},8,["loading","finished"])])}}},U=A(N,[["__scopeId","data-v-c46d54ac"]]);export{U as A};
