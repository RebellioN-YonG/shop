import{_ as U,J as B,p as $,aG as q,r as C,S as L,ad as M,o as r,c as S,a as o,f as m,w as n,aH as A,as as f,aI as N,aJ as R,ai as F,aK as G,N as I,V as i,W as p,$ as d,a0 as J,aL as T,X as E}from"./index-786b1c77.js";import{C as H}from"./index-1d576add.js";import{R as P,a as Z}from"./index-0611bba7.js";import"./index-6e9a7553.js";import"./index-2de2f4d6.js";import{F as K}from"./index-9ab1ad7c.js";import{F as O}from"./index-628f7f37.js";import"./use-id-75d822c1.js";const h=["https://w.wallhaven.cc/full/o5/wallhaven-o5363p.jpg","https://w.wallhaven.cc/full/kx/wallhaven-kxwgvd.png","https://w.wallhaven.cc/full/p9/wallhaven-p98xkp.jpg","https://w.wallhaven.cc/full/5g/wallhaven-5gwq17.png","https://w.wallhaven.cc/full/yx/wallhaven-yxmrkd.jpg","https://wpimg.wallstcn.com/f778738c-e4f8-4870-b634-56703b4acafe.gif?imageView2/1/w/88/h/88","https://w.wallhaven.cc/full/l8/wallhaven-l8mx1l.jpg","https://w.wallhaven.cc/full/yx/wallhaven-yxmo5k.png","https://w.wallhaven.cc/full/6d/wallhaven-6dogj7.png","https://w.wallhaven.cc/full/d6/wallhaven-d6g33m.jpg","https://w.wallhaven.cc/full/x6/wallhaven-x68kjl.jpg","https://w.wallhaven.cc/full/yx/wallhaven-yxm3zx.png","https://w.wallhaven.cc/full/gp/wallhaven-gpjj9q.jpg","https://w.wallhaven.cc/full/we/wallhaven-weyz9r.png","https://w.wallhaven.cc/full/l8/wallhaven-l839zy.jpg","https://img1.baidu.com/it/u=2029513305,2137933177&fm=253&fmt=auto&app=138&f=JPEG?w=500&h=472"],W=()=>h[Math.round(Math.random()*(h.length-1))];const X={class:"container"},Q={class:"user_img"},Y=["src"],D={style:{margin:"16px"}},ee={__name:"Login",setup(ae){const _=W(),c=()=>({avatar:"https://img1.baidu.com/it/u=3269593700,2695107730&fm=253&fmt=auto&app=138&f=JPEG?w=500&h=500",name:"",password:"",sex:1,sign:"",secretAnswer:""}),a=B(c());let v=!1;$(q(a,"username"),s=>{const e=T(s).avatar;v?(a.avatar=_,v=!1):e&&(a.avatar=e,v=!0)});const l=C(!1),y=L(),x=M(),V=async s=>{if(console.table(s),l.value){const e=await A(s);e.code===0&&(f({message:"注册成功",duration:1500}),Object.assign(a,c()),a.username=s.name,a.avatar=s.avatar,l.value=!1,console.log(a)),console.log(e)}else{const e=await N(s);console.log(e),e.code===0?(f({message:"登录成功",duration:1500}),x.setInfo({name:s.name,avatar:e.data.avatar,sign:e.data.sign,sex:e.data.sex}),R(e.data.token,e.data.expires_in),F(),G(s.name,{avatar:e.data.avatar,pwd:s.password,sign:e.data.sign,sex:e.data.sex,lastLogin:!0}),y.replace("/home")):(console.log("登陆失败"),showFailToast({message:e.msg,duration:1500}))}};return(s,e)=>{const k=I,u=K,g=P,b=Z,j=H,w=E,z=O;return r(),S("main",null,[o(k,{title:l.value?"注册":s.$route.meta.title,"left-arrow":"",onClickLeft:e[0]||(e[0]=t=>s.$router.replace("/home")),fixed:""},null,8,["title"]),m("div",X,[m("div",Q,[m("img",{src:a.avatar,alt:"avatar"},null,8,Y)]),o(z,{onSubmit:V},{default:n(()=>[o(j,{inset:""},{default:n(()=>[o(u,{modelValue:a.username,"onUpdate:modelValue":e[1]||(e[1]=t=>a.username=t),modelModifiers:{lazy:!0,trim:!0},name:"name",label:"用户名",placeholder:"用户名",rules:[{required:!0,message:"请填写用户名"},{pattern:/^[-_a-zA-Z0-9]{4,16}$/,message:"只能包含4-16位字母数字下划线减号"}]},null,8,["modelValue"]),o(u,{modelValue:a.password,"onUpdate:modelValue":e[2]||(e[2]=t=>a.password=t),modelModifiers:{lazy:!0,trim:!0},type:"password",name:"password",autocomplete:"",label:"密码",placeholder:"密码",rules:[{required:!0,message:"请填写密码"},{pattern:/^[-_a-zA-Z0-9]{6,16}$/,message:"只能包含6-16位字母数字下划线减号"}]},null,8,["modelValue"]),l.value?(r(),i(u,{key:0,modelValue:a.avatar,"onUpdate:modelValue":e[3]||(e[3]=t=>a.avatar=t),modelModifiers:{lazy:!0,trim:!0},type:"url",name:"avatar",label:"头像",placeholder:"图片地址",rules:[{required:!0,message:"请填写图片地址"},{pattern:/^(http|ftp|https):\/\/([\w\-]+(\.[\w\-]+)*\/)*[\w\-]+(\.[\w\-]+)*\/?(\?([\w\-\.,@?^=%&:\/~\+#]*)+)?/,message:"请输入有效的网址"}]},null,8,["modelValue"])):p("",!0),l.value?(r(),i(u,{key:1,name:"sex",label:"性别"},{input:n(()=>[o(b,{modelValue:a.sex,"onUpdate:modelValue":e[4]||(e[4]=t=>a.sex=t),direction:"horizontal"},{default:n(()=>[o(g,{name:1},{default:n(()=>e[9]||(e[9]=[d("男")])),_:1}),o(g,{name:0},{default:n(()=>e[10]||(e[10]=[d("女")])),_:1})]),_:1},8,["modelValue"])]),_:1})):p("",!0),l.value?(r(),i(u,{key:2,modelValue:a.sign,"onUpdate:modelValue":e[5]||(e[5]=t=>a.sign=t),modelModifiers:{lazy:!0,trim:!0},type:"text",name:"sign",label:"签名",placeholder:"个性签名",rules:[{required:!0,message:"请填写个性签名"}]},null,8,["modelValue"])):p("",!0),l.value?(r(),i(u,{key:3,modelValue:a.secretAnswer,"onUpdate:modelValue":e[6]||(e[6]=t=>a.secretAnswer=t),modelModifiers:{lazy:!0,trim:!0},type:"text",name:"secret_answer",label:"密保",placeholder:"验证密保",rules:[{required:!0,message:"请填写密保"}]},null,8,["modelValue"])):p("",!0)]),_:1}),m("div",D,[o(w,{round:"",block:"",type:l.value?"primary":"success","native-type":"submit"},{default:n(()=>[d(J(l.value?"注册":"登录"),1)]),_:1},8,["type"]),l.value?p("",!0):(r(),i(w,{key:0,class:"registerBtn",round:"",block:"",type:"primary",onClick:e[7]||(e[7]=t=>l.value=!0)},{default:n(()=>e[11]||(e[11]=[d(" 注册 ")])),_:1})),l.value?(r(),i(w,{key:1,class:"registerBtn",round:"",block:"",plain:"",type:"primary",onClick:e[8]||(e[8]=t=>l.value=!1)},{default:n(()=>e[12]||(e[12]=[d(" 返回登录 ")])),_:1})):p("",!0)])]),_:1})])])}}},pe=U(ee,[["__scopeId","data-v-86304632"]]);export{pe as default};
